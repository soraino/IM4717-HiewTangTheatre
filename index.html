<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>HiewTang Theatre</title>
        <link rel="stylesheet" href="./css/main.css" />
        <link rel="stylesheet" href="./css/index.css" />
    </head>
    <body>
        <nav class="navbar">
            <div class="navbar-menu container">
                <div class="navbar-end">
                    <a class="navbar-item"> Home </a>
                    <a href="moviesView.php" class="navbar-item"> Movies </a>
                    <a class="navbar-item"> Check Bookings </a>
                    <div class="navbar-item">
                        <input
                            class="input is-rounded"
                            type="text"
                            placeholder="Search"
                        />
                        <svg class="search-icon" viewBox="0 0 12 13">
                            <g stroke-width="2" stroke="#999999" fill="none">
                                <path d="M11.29 11.71l-4-4" />
                                <circle cx="5" cy="5" r="4" />
                            </g>
                        </svg>
                    </div>
                </div>
            </div>
        </nav>
        <div class="carousel-wrapper">
            <div class="carousel">
                <img
                    class="carousel__photo initial"
                    src="./assets/movie/banner/Vanguard.jpg"
                />
                <img
                    class="carousel__photo"
                    src="./assets/movie/banner/Mulan.jpg"
                />
                <img
                    class="carousel__photo"
                    src="./assets/movie/banner/Tunnel.jpg"
                />
                <img
                    class="carousel__photo"
                    src="./assets/movie/banner/LetItSnow.jpg"
                />

                <div class="carousel__button--next"></div>
                <div class="carousel__button--prev"></div>
            </div>
        </div>
        <main class="container">
            <div class="box">
                <h2>Quick Purchase</h2>
                <form>
                    <div class="row">
                        <div class="col">
                            Lorem ipsum, dolor sit amet consectetur adipisicing
                            elit. Cupiditate, dolores. Fugiat non porro harum
                            alias quis incidunt, nesciunt aperiam cumque.
                        </div>
                        <div class="col">
                            Lorem ipsum dolor sit amet, consectetur adipisicing
                            elit. Sunt dolorem beatae nostrum quos possimus
                            ipsa, est voluptatem atque quam veritatis?
                        </div>
                        <div class="col">
                            Lorem, ipsum dolor sit amet consectetur adipisicing
                            elit. Vel inventore ullam sint vitae quasi qui
                            suscipit, reiciendis officia nemo blanditiis.
                        </div>
                    </div>
                </form>
            </div>
            <div>
                <h2>Now Showing</h2>
                <div id="slider1" class="slider">
                    <div class="wrapper">
                        <div id="slides1" class="slides shifting">
                            <div class="slide">
                                <img
                                    src="https://picsum.photos/200/300"
                                    alt=""
                                />
                            </div>
                            <div class="slide">
                                <img
                                    src="https://picsum.photos/200/300"
                                    alt=""
                                />
                            </div>
                            <div class="slide">
                                <img
                                    src="https://picsum.photos/200/300"
                                    alt=""
                                />
                            </div>
                            <div class="slide">
                                <img
                                    src="https://picsum.photos/200/300"
                                    alt=""
                                />
                            </div>
                            <div class="slide">
                                <img
                                    src="https://picsum.photos/200/300"
                                    alt=""
                                />
                            </div>
                        </div>
                    </div>
                    <a id="prev1" class="control prev" style="top: 45%"></a>
                    <a id="next1" class="control next" style="top: 45%"></a>
                </div>
            </div>
            <div>
                <h2>Trending</h2>
                <div id="slider2" class="slider">
                    <div class="wrapper">
                        <div id="slides2" class="slides shifting">
                            <div class="slide">
                                <img
                                    src="https://picsum.photos/200/300"
                                    alt=""
                                />
                            </div>
                            <div class="slide">
                                <img
                                    src="https://picsum.photos/200/300"
                                    alt=""
                                />
                            </div>
                            <div class="slide">
                                <img
                                    src="https://picsum.photos/200/300"
                                    alt=""
                                />
                            </div>
                            <div class="slide">
                                <img
                                    src="https://picsum.photos/200/300"
                                    alt=""
                                />
                            </div>
                            <div class="slide">
                                <img
                                    src="https://picsum.photos/200/300"
                                    alt=""
                                />
                            </div>
                            <div class="slide">
                                <img
                                    src="https://picsum.photos/200/300"
                                    alt=""
                                />
                            </div>
                            <div class="slide">
                                <img
                                    src="https://picsum.photos/200/300"
                                    alt=""
                                />
                            </div>
                        </div>
                    </div>
                    <a id="prev2" class="control prev" style="top: 85%"></a>
                    <a id="next2" class="control next" style="top: 85%"></a>
                </div>
            </div>
        </main>
        <footer class="footer">
            <div class="footer-content">
                <div class="container">
                    <p>Copyright lol</p>
                </div>
            </div>
        </footer>
    </body>
    <script src="./js/slider.js"></script>
    <script>
        initSlider(1);
        initSlider(2);
        const slidesContainers = document.querySelectorAll(".slide-container");
        const wrapper = document.querySelector(".wrapper");

        // Variables to target our base class,  get carousel items, count how many carousel items there are, set the slide to 0 (which is the number that tells us the frame we're on), and set motion to true which disables interactivity.
        const itemClassName = "carousel__photo";
        (items = document.getElementsByClassName(itemClassName)),
            (totalItems = items.length),
            (slide = 0),
            (moving = true);

        // To initialise the carousel we'll want to update the DOM with our own classes
        function setInitialClasses() {
            // Target the last, initial, and next items and give them the relevant class.
            // This assumes there are three or more items.
            items[totalItems - 1].classList.add("prev");
            items[0].classList.add("active");
            items[1].classList.add("next");
        }

        // Set click events to navigation buttons

        function setEventListeners() {
            const next = document.getElementsByClassName(
                "carousel__button--next"
            )[0];
            const prev = document.getElementsByClassName(
                "carousel__button--prev"
            )[0];

            next.addEventListener("click", moveNext);
            prev.addEventListener("click", movePrev);
        }

        // Disable interaction by setting 'moving' to true for the same duration as our transition (0.5s = 500ms)
        function disableInteraction() {
            moving = true;

            setTimeout(function () {
                moving = false;
            }, 500);
        }

        function moveCarouselTo(slide) {
            // Check if carousel is moving, if not, allow interaction
            if (!moving) {
                // temporarily disable interactivity
                disableInteraction();

                // Preemptively set variables for the current next and previous slide, as well as the potential next or previous slide.
                let newPrevious = slide - 1;
                let newNext = slide + 1;
                let oldPrevious = slide - 2;
                let oldNext = slide + 2;

                // Checks if the new potential slide is out of bounds and sets slide numbers
                if (newPrevious <= 0) {
                    oldPrevious = totalItems - 1;
                } else if (newNext >= totalItems - 1) {
                    oldNext = 0;
                }

                // Check if current slide is at the beginning or end and sets slide numbers
                if (slide === 0) {
                    newPrevious = totalItems - 1;
                    oldPrevious = totalItems - 2;
                    oldNext = slide + 1;
                } else if (slide === totalItems - 1) {
                    newPrevious = slide - 1;
                    newNext = 0;
                    oldNext = 1;
                }

                // Now we've worked out where we are and where we're going, by adding and removing classes, we'll be triggering the carousel's transitions.

                // Based on the current slide, reset to default classes.
                items[oldPrevious].className = itemClassName;
                items[oldNext].className = itemClassName;

                // Add the new classes
                items[newPrevious].className = itemClassName + " prev";
                items[slide].className = itemClassName + " active";
                items[newNext].className = itemClassName + " next";
            }
        }

        // Next navigation handler
        function moveNext() {
            // Check if moving
            if (!moving) {
                // If it's the last slide, reset to 0, else +1
                if (slide === totalItems - 1) {
                    slide = 0;
                } else {
                    slide++;
                }

                // Move carousel to updated slide
                moveCarouselTo(slide);
            }
        }

        // Previous navigation handler
        function movePrev() {
            // Check if moving
            if (!moving) {
                // If it's the first slide, set as the last slide, else -1
                if (slide === 0) {
                    slide = totalItems - 1;
                } else {
                    slide--;
                }

                // Move carousel to updated slide
                moveCarouselTo(slide);
            }
        }

        // Initialise carousel
        function initCarousel() {
            setInitialClasses();
            setEventListeners();

            // Set moving to false now that the carousel is ready
            moving = false;
        }

        // make it rain
        initCarousel();
    </script>
</html>
